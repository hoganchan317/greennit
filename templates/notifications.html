<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <title>通知 - MyMiniReddit</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
<div class="max-w-3xl mx-auto py-8">

  {% include "_navbar.html" %}

  <h1 class="text-2xl font-bold mb-4 flex items-center gap-2">
    通知中心
    {% if unread_count > 0 %}
      <span class="text-xs px-2 py-0.5 rounded-full bg-red-500 text-white">
        未读 {{ unread_count }}
      </span>
    {% endif %}
  </h1>

  <div class="mb-4 flex justify-between items-center text-sm">
    <div class="text-slate-400">
      共 {{ notifications|length }} 条通知
    </div>
    {% if notifications %}
      <form method="post" action="/notifications/read_all">
        <button class="px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 text-xs">
          标记全部为已读
        </button>
      </form>
    {% endif %}
  </div>

  <div class="space-y-3">
    {% if notifications %}
      {% for n in notifications %}
        {# n: (id, type, message, is_read, related_post_id, related_comment_id, created_at, from_username) #}
        <div class="rounded-xl p-4 bg-slate-800/80 flex justify-between items-start
                    {% if not n[3] %}border-l-4 border-emerald-400{% else %}border border-slate-700{% endif %}">
          <div class="space-y-1">
            <div class="text-sm">
              {{ n[2] }}
              {% if n[4] %}
                <a href="/post/{{ n[4] }}" class="text-sky-400 hover:underline ml-1">
                  查看帖子
                </a>
              {% endif %}
            </div>
            <div class="text-xs text-slate-400">
              {% if n[7] %}
                来自：<a href="/user/{{ n[7] }}" class="hover:underline">{{ n[7] }}</a>
                ·
              {% endif %}
              {{ n[6].strftime('%Y-%m-%d %H:%M') if n[6] else '' }}
              {% if not n[3] %}
                · <span class="text-emerald-400">未读</span>
              {% else %}
                · <span class="text-slate-500">已读</span>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="bg-slate-800/60 rounded-xl p-6 text-center text-slate-400">
        暂时还没有任何通知。
      </div>
    {% endif %}
  </div>

</div>
</body>
</html>